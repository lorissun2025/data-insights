<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¸‚åœºæ´å¯Ÿä»ªè¡¨ç›˜ - æ™ºèƒ½æ•°æ®å¹³å°</title>
    <!-- å¼•å…¥å¿…è¦çš„åº“ -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@3.3.4/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios@1.6.2/dist/axios.min.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #0a0e27;
            background-image:
                radial-gradient(ellipse at top, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at bottom, rgba(139, 92, 246, 0.08) 0%, transparent 50%);
            color: #e2e8f0;
            min-height: 100vh;
        }

        /* é¡¶éƒ¨å¯¼èˆªæ  */
        .navbar {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(99, 102, 241, 0.2);
            padding: 16px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-brand {
            font-size: 22px;
            font-weight: 700;
            background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-menu {
            display: flex;
            gap: 8px;
        }

        .nav-item {
            padding: 8px 16px;
            color: #94a3b8;
            text-decoration: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .nav-item:hover {
            background: rgba(59, 130, 246, 0.1);
            color: #e2e8f0;
        }

        .nav-item.active {
            background: rgba(59, 130, 246, 0.15);
            color: #60a5fa;
        }

        .nav-user {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .user-name {
            font-size: 14px;
            color: #cbd5e1;
        }

        .logout-btn {
            padding: 6px 14px;
            background: rgba(239, 68, 68, 0.15);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 6px;
            color: #f87171;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: rgba(239, 68, 68, 0.25);
        }

        .export-btn {
            padding: 10px 20px;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(139, 92, 246, 0.2));
            border: 1px solid rgba(99, 102, 241, 0.4);
            border-radius: 8px;
            color: #60a5fa;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .export-btn:hover {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.3), rgba(139, 92, 246, 0.3));
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .header {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.15) 0%, rgba(139, 92, 246, 0.15) 100%);
            border-bottom: 1px solid rgba(99, 102, 241, 0.3);
            color: white;
            padding: 24px 32px;
        }

        .header h1 {
            font-size: 26px;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .header p {
            font-size: 14px;
            color: #94a3b8;
            font-weight: 300;
        }

        .container {
            padding: 28px;
            max-width: 1600px;
            margin: 0 auto;
        }

        .toolbar {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(99, 102, 241, 0.2);
            padding: 20px 24px;
            border-radius: 12px;
            margin-bottom: 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.05);
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .toolbar label {
            font-size: 14px;
            color: #94a3b8;
            margin-right: 8px;
            font-weight: 500;
        }

        .toolbar select {
            padding: 9px 18px;
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            background: rgba(30, 41, 59, 0.8);
            color: #e2e8f0;
            transition: all 0.3s ease;
        }

        .toolbar select:hover {
            border-color: rgba(139, 92, 246, 0.5);
            background: rgba(30, 41, 59, 0.95);
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 24px;
        }

        .kpi-card {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(99, 102, 241, 0.2);
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .kpi-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6, #a78bfa);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .kpi-card:hover {
            border-color: rgba(139, 92, 246, 0.4);
            box-shadow: 0 8px 30px rgba(59, 130, 246, 0.2);
            transform: translateY(-4px);
        }

        .kpi-card:hover::before {
            opacity: 1;
        }

        .kpi-title {
            font-size: 13px;
            color: #94a3b8;
            margin-bottom: 14px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .kpi-value {
            display: flex;
            align-items: baseline;
            margin-bottom: 10px;
        }

        .kpi-value .number {
            font-size: 36px;
            font-weight: 700;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0e7ff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.5px;
        }

        .kpi-value .unit {
            font-size: 14px;
            color: #64748b;
            margin-left: 6px;
            font-weight: 500;
        }

        .kpi-growth {
            display: flex;
            align-items: center;
            font-size: 12px;
            font-weight: 600;
            gap: 4px;
        }

        .kpi-growth.up {
            color: #10b981;
        }

        .kpi-growth.down {
            color: #ef4444;
        }

        .chart-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 24px;
            margin-bottom: 24px;
        }

        .chart-card {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(99, 102, 241, 0.2);
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }

        .chart-card:hover {
            border-color: rgba(139, 92, 246, 0.3);
        }

        .chart-card h3 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 18px;
            color: #f1f5f9;
        }

        .chart-container {
            width: 100%;
            height: 350px;
        }

        .table-card {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(99, 102, 241, 0.2);
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }

        .table-card h3 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 18px;
            color: #f1f5f9;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 14px 18px;
            text-align: left;
            border-bottom: 1px solid rgba(99, 102, 241, 0.1);
        }

        th {
            background: rgba(30, 41, 59, 0.5);
            font-weight: 600;
            font-size: 13px;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        td {
            font-size: 14px;
            color: #cbd5e1;
        }

        tr:hover td {
            background: rgba(59, 130, 246, 0.05);
        }

        .score-bar {
            width: 100px;
            height: 8px;
            background: rgba(30, 41, 59, 0.8);
            border-radius: 4px;
            overflow: hidden;
            display: inline-block;
            vertical-align: middle;
            border: 1px solid rgba(99, 102, 241, 0.2);
        }

        .score-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #3b82f6, #8b5cf6);
            transition: width 0.3s;
            box-shadow: 0 0 10px rgba(139, 92, 246, 0.5);
        }

        .tag {
            display: inline-block;
            padding: 5px 14px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
        }

        .tag.high {
            background: rgba(16, 185, 129, 0.15);
            color: #10b981;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .tag.medium {
            background: rgba(59, 130, 246, 0.15);
            color: #3b82f6;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .tag.low {
            background: rgba(249, 115, 22, 0.15);
            color: #f97316;
            border: 1px solid rgba(249, 115, 22, 0.3);
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #94a3b8;
            font-size: 14px;
        }

        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 11px;
            margin-left: 8px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge.beta {
            background: linear-gradient(135deg, rgba(249, 115, 22, 0.2) 0%, rgba(234, 179, 8, 0.2) 100%);
            color: #fbbf24;
            border: 1px solid rgba(251, 191, 36, 0.4);
            box-shadow: 0 0 10px rgba(251, 191, 36, 0.2);
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- å¯¼èˆªæ  -->
        <nav class="navbar">
            <div class="nav-brand">DATA INSIGHTS</div>
            <div class="nav-menu">
                <a class="nav-item active" href="dashboard.html">å¸‚åœºæ´å¯Ÿ</a>
                <a class="nav-item" href="competitor.html">ç«å“åˆ†æ</a>
                <a class="nav-item" href="forecast.html">é”€å”®é¢„æµ‹</a>
                <a class="nav-item" href="customer.html">å®¢æˆ·æ´å¯Ÿ</a>
                <a class="nav-item" href="price.html">ä»·æ ¼åˆ†æ</a>
                <a class="nav-item" href="supply-chain.html">æ™ºèƒ½ä¾›åº”é“¾</a>
                <a class="nav-item" href="medical-performance.html">åŒ»ç–—æ•ˆèƒ½</a>
                <a class="nav-item" href="investment.html">æŠ•èµ„æƒ…æŠ¥</a>
                <a class="nav-item" href="rwa.html">ç ”å‘æ”¯æŒ</a>
                <a class="nav-item" href="assistant.html">AIåŠ©æ‰‹</a>
            </div>
            <div class="nav-user">
                <span class="user-name">{{ userName }}</span>
                <button class="logout-btn" @click="logout">é€€å‡ºç™»å½•</button>
            </div>
        </nav>

        <div class="header">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <h1>å¸‚åœºæ´å¯Ÿä»ªè¡¨ç›˜</h1>
                    <p>åŸºäºå…¨å›½å¯ä¿¡æ•°æ®çš„æ™ºèƒ½åˆ†æå¹³å°</p>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button @click="exportData('csv')" class="export-btn">ğŸ“Š å¯¼å‡ºCSV</button>
                    <button @click="exportData('html')" class="export-btn">ğŸ“„ å¯¼å‡ºæŠ¥å‘Š</button>
                </div>
            </div>
        </div>

        <div class="container">
            <!-- å·¥å…·æ  -->
            <div class="toolbar">
                <div>
                    <label>äº§å“ç­›é€‰:</label>
                    <select v-model="selectedProduct">
                        <option value="all">å…¨éƒ¨äº§å“</option>
                        <option value="prod001">é˜¿è«è¥¿æ—èƒ¶å›Š</option>
                        <option value="prod002">å¸ƒæ´›èŠ¬ç¼“é‡Šèƒ¶å›Š</option>
                        <option value="prod003">å¥¥ç¾æ‹‰å”‘è‚ æº¶èƒ¶å›Š</option>
                    </select>
                </div>
                <div>
                    <label>æ—¶é—´èŒƒå›´:</label>
                    <select v-model="dateRange">
                        <option value="3m">æœ€è¿‘3ä¸ªæœˆ</option>
                        <option value="6m">æœ€è¿‘6ä¸ªæœˆ</option>
                        <option value="12m">æœ€è¿‘12ä¸ªæœˆ</option>
                    </select>
                </div>
            </div>

            <div v-if="loading" class="loading">
                æ•°æ®åŠ è½½ä¸­,è¯·ç¨å€™...
            </div>

            <div v-else>
                <!-- KPIå¡ç‰‡ -->
                <div class="kpi-grid">
                    <div class="kpi-card" v-for="(kpi, index) in kpis" :key="index">
                        <div class="kpi-title">{{ kpi.title }}</div>
                        <div class="kpi-value">
                            <span class="number">{{ kpi.value.toLocaleString() }}</span>
                            <span class="unit">{{ kpi.unit }}</span>
                        </div>
                        <div class="kpi-growth" :class="kpi.trend">
                            <span>{{ kpi.trend === 'up' ? 'â†‘' : 'â†“' }}</span>
                            <span>{{ Math.abs(kpi.growth).toFixed(2) }}%</span>
                            <span style="margin-left: 4px; color: #64748b;">vs ä¸ŠæœŸ</span>
                        </div>
                    </div>
                </div>

                <!-- å›¾è¡¨è¡Œ 1 -->
                <div class="chart-row">
                    <div class="chart-card">
                        <h3>é”€å”®è¶‹åŠ¿åˆ†æ</h3>
                        <div ref="salesTrendChart" class="chart-container"></div>
                    </div>
                    <div class="chart-card">
                        <h3>å¸‚åœºä»½é¢å˜åŒ–</h3>
                        <div ref="marketShareChart" class="chart-container"></div>
                    </div>
                </div>

                <!-- å›¾è¡¨è¡Œ 2 -->
                <div class="chart-row">
                    <div class="chart-card">
                        <h3>ç«å“ç»¼åˆå¯¹æ¯”</h3>
                        <div ref="competitorChart" class="chart-container"></div>
                    </div>
                    <div class="chart-card">
                        <h3>åŒºåŸŸå¸‚åœºè¡¨ç°</h3>
                        <div ref="regionalMapChart" class="chart-container"></div>
                    </div>
                </div>

                <!-- æœºä¼šè¯†åˆ«è¡¨æ ¼ -->
                <div class="table-card">
                    <h3>å¸‚åœºæœºä¼šè¯†åˆ« <span class="badge beta">AIæ¨è</span></h3>
                    <table>
                        <thead>
                            <tr>
                                <th>åŒºåŸŸ</th>
                                <th>åŸå¸‚</th>
                                <th>å¸‚åœºè§„æ¨¡</th>
                                <th>å¢é•¿ç‡</th>
                                <th>ç«äº‰å¼ºåº¦</th>
                                <th>æ¸—é€ç‡</th>
                                <th>æœºä¼šå¾—åˆ†</th>
                                <th>å»ºè®®</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="(opp, index) in opportunities" :key="index">
                                <td>{{ opp.region }}</td>
                                <td>{{ opp.city }}</td>
                                <td>{{ opp.market_size }}ä¸‡å…ƒ</td>
                                <td :style="{color: opp.growth_rate > 20 ? '#10b981' : '#cbd5e1'}">
                                    {{ opp.growth_rate }}%
                                </td>
                                <td>{{ opp.competitor_count }}å®¶</td>
                                <td>{{ opp.penetration_rate }}%</td>
                                <td>
                                    <div class="score-bar">
                                        <div class="score-fill" :style="{width: opp.score + '%'}"></div>
                                    </div>
                                    <span style="margin-left: 8px; font-size: 12px;">{{ opp.score }}</span>
                                </td>
                                <td>
                                    <span class="tag" :class="opp.level === 'é«˜æ½œåŠ›' ? 'high' : opp.level === 'ä¸­ç­‰' ? 'medium' : 'low'">
                                        {{ opp.level }}
                                    </span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;
        const API_BASE = 'http://localhost:8000';

        createApp({
            data() {
                return {
                    loading: true,
                    selectedProduct: 'all',
                    dateRange: '12m',
                    kpis: [],
                    opportunities: [],
                    userName: 'ç®¡ç†å‘˜',
                    token: localStorage.getItem('token')
                };
            },
            mounted() {
                // æ£€æŸ¥ç™»å½•çŠ¶æ€
                if (!this.token) {
                    window.location.href = 'login.html';
                    return;
                }

                // è·å–ç”¨æˆ·ä¿¡æ¯
                const userInfo = localStorage.getItem('userInfo');
                if (userInfo) {
                    this.userName = JSON.parse(userInfo).full_name || 'ç®¡ç†å‘˜';
                }

                // åŠ è½½æ•°æ®
                this.refreshData();
            },
            methods: {
                logout() {
                    localStorage.removeItem('token');
                    localStorage.removeItem('userInfo');
                    window.location.href = 'login.html';
                },
                async exportData(format) {
                    // å¯¼å‡ºå½“å‰æ•°æ®
                    const data = {
                        columns: ['æ—¥æœŸ', 'é”€å”®é¢(ä¸‡å…ƒ)', 'é”€å”®é‡(ä¸‡ç›’)', 'åŒæ¯”å¢é•¿(%)'],
                        data: this.salesTrend.dates.map((date, index) => ({
                            'æ—¥æœŸ': date,
                            'é”€å”®é¢(ä¸‡å…ƒ)': this.salesTrend.sales[index],
                            'é”€å”®é‡(ä¸‡ç›’)': this.salesTrend.volumes[index],
                            'åŒæ¯”å¢é•¿(%)': this.salesTrend.growth[index]
                        }))
                    };

                    if (format === 'csv') {
                        this.exportToCSV(data.data, Object.keys(data.data[0]), 'dashboard_sales.csv');
                    } else if (format === 'html') {
                        this.exportToHTML(data);
                    }
                },
                exportToCSV(data, columns, filename) {
                    let csvContent = columns.join(',') + '\n';
                    data.forEach(row => {
                        const values = columns.map(col => row[col] || '');
                        csvContent += values.join(',') + '\n';
                    });

                    const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = filename;
                    a.click();
                    window.URL.revokeObjectURL(url);
                },
                exportToHTML(data) {
                    const htmlContent = `
                        <!DOCTYPE html>
                        <html>
                        <head>
                            <meta charset="UTF-8">
                            <title>é”€å”®æ•°æ®åˆ†ææŠ¥å‘Š</title>
                            <style>
                                body { font-family: Arial, sans-serif; padding: 20px; }
                                h1 { color: #3b82f6; }
                                table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                                th { background: #3b82f6; color: white; padding: 12px; }
                                td { border: 1px solid #ddd; padding: 10px; }
                            </style>
                        </head>
                        <body>
                            <h1>é”€å”®æ•°æ®åˆ†ææŠ¥å‘Š</h1>
                            <p>ç”Ÿæˆæ—¶é—´: ${new Date().toLocaleString()}</p>
                            <table>
                                <tr>
                                    ${data.columns.map(col => `<th>${col}</th>`).join('')}
                                </tr>
                                ${data.data.map(row => `
                                    <tr>
                                        ${data.columns.map(col => `<td>${row[col]}</td>`).join('')}
                                    </tr>
                                `).join('')}
                            </table>
                        </body>
                        </html>
                    `;

                    const blob = new Blob([htmlContent], { type: 'text/html' });
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'dashboard_report.html';
                    a.click();
                    window.URL.revokeObjectURL(url);
                },

                async refreshData() {
                    this.loading = true;
                    try {
                        // å¹¶è¡ŒåŠ è½½æ‰€æœ‰æ•°æ®
                        const [kpiRes, trendRes, shareRes, oppRes, compRes, regionalRes] = await Promise.all([
                            axios.get(`${API_BASE}/api/dashboard/kpi`, {
                                headers: { Authorization: `Bearer ${this.token}` }
                            }),
                            axios.get(`${API_BASE}/api/dashboard/sales-trend`, {
                                headers: { Authorization: `Bearer ${this.token}` }
                            }),
                            axios.get(`${API_BASE}/api/dashboard/market-share`, {
                                headers: { Authorization: `Bearer ${this.token}` }
                            }),
                            axios.get(`${API_BASE}/api/dashboard/opportunities`, {
                                headers: { Authorization: `Bearer ${this.token}` }
                            }),
                            axios.get(`${API_BASE}/api/competitor/comparison`, {
                                headers: { Authorization: `Bearer ${this.token}` }
                            }),
                            axios.get(`${API_BASE}/api/competitor/regional`, {
                                headers: { Authorization: `Bearer ${this.token}` }
                            })
                        ]);

                        this.kpis = kpiRes.data.data;
                        this.opportunities = oppRes.data.data;
                        this.salesTrendData = trendRes.data;
                        this.marketShareData = shareRes.data;
                        this.competitorData = compRes.data;
                        this.regionalData = regionalRes.data;

                        this.loading = false;

                        // æ¸²æŸ“å›¾è¡¨
                        this.$nextTick(() => {
                            this.renderSalesTrendChart();
                            this.renderMarketShareChart();
                            this.renderCompetitorChart();
                            this.renderRegionalMapChart();
                        });
                    } catch (error) {
                        console.error('åŠ è½½æ•°æ®å¤±è´¥:', error);
                        if (error.response?.status === 401) {
                            this.logout();
                        }
                    }
                },

                renderSalesTrendChart() {
                    const chart = echarts.init(this.$refs.salesTrendChart);
                    const data = this.salesTrendData;

                    const option = {
                        tooltip: {
                            trigger: 'axis',
                            axisPointer: { type: 'cross' },
                            backgroundColor: 'rgba(15, 23, 42, 0.95)',
                            borderColor: 'rgba(99, 102, 241, 0.3)',
                            textStyle: { color: '#e2e8f0' }
                        },
                        legend: {
                            data: ['é”€å”®é¢', 'é”€å”®é‡', 'é¢„æµ‹'],
                            top: 10,
                            textStyle: { color: '#94a3b8' }
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '3%',
                            containLabel: true
                        },
                        xAxis: {
                            type: 'category',
                            boundaryGap: false,
                            data: data.months,
                            axisLine: { lineStyle: { color: 'rgba(99, 102, 241, 0.3)' } },
                            axisLabel: { color: '#94a3b8' }
                        },
                        yAxis: [
                            {
                                type: 'value',
                                name: 'é”€å”®é¢(ä¸‡å…ƒ)',
                                position: 'left',
                                nameTextStyle: { color: '#94a3b8' },
                                axisLine: { lineStyle: { color: 'rgba(99, 102, 241, 0.3)' } },
                                axisLabel: { color: '#94a3b8' },
                                splitLine: { lineStyle: { color: 'rgba(99, 102, 241, 0.1)' } }
                            },
                            {
                                type: 'value',
                                name: 'é”€å”®é‡(ä¸‡ç›’)',
                                position: 'right',
                                nameTextStyle: { color: '#94a3b8' },
                                axisLine: { lineStyle: { color: 'rgba(99, 102, 241, 0.3)' } },
                                axisLabel: { color: '#94a3b8' },
                                splitLine: { show: false }
                            }
                        ],
                        series: [
                            {
                                name: 'é”€å”®é¢',
                                type: 'line',
                                smooth: true,
                                data: data.sales,
                                itemStyle: { color: '#3b82f6' },
                                areaStyle: {
                                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                        { offset: 0, color: 'rgba(59, 130, 246, 0.4)' },
                                        { offset: 1, color: 'rgba(59, 130, 246, 0.05)' }
                                    ])
                                }
                            },
                            {
                                name: 'é”€å”®é‡',
                                type: 'bar',
                                yAxisIndex: 1,
                                data: data.quantity,
                                itemStyle: {
                                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                        { offset: 0, color: '#10b981' },
                                        { offset: 1, color: '#059669' }
                                    ])
                                }
                            },
                            {
                                name: 'é¢„æµ‹',
                                type: 'line',
                                smooth: true,
                                data: data.forecast,
                                lineStyle: { type: 'dashed', color: '#fbbf24' },
                                itemStyle: { color: '#fbbf24' }
                            }
                        ]
                    };
                    chart.setOption(option);
                    window.addEventListener('resize', () => chart.resize());
                },

                renderMarketShareChart() {
                    const chart = echarts.init(this.$refs.marketShareChart);
                    const data = this.marketShareData;

                    const option = {
                        tooltip: {
                            trigger: 'axis',
                            axisPointer: { type: 'cross' },
                            backgroundColor: 'rgba(15, 23, 42, 0.95)',
                            borderColor: 'rgba(99, 102, 241, 0.3)',
                            textStyle: { color: '#e2e8f0' }
                        },
                        legend: {
                            data: data.series.map(s => s.name),
                            top: 10,
                            textStyle: { color: '#94a3b8' }
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '3%',
                            containLabel: true
                        },
                        xAxis: {
                            type: 'category',
                            boundaryGap: false,
                            data: data.quarters,
                            axisLine: { lineStyle: { color: 'rgba(99, 102, 241, 0.3)' } },
                            axisLabel: { color: '#94a3b8' }
                        },
                        yAxis: {
                            type: 'value',
                            name: 'å¸‚åœºä»½é¢(%)',
                            max: 100,
                            nameTextStyle: { color: '#94a3b8' },
                            axisLine: { lineStyle: { color: 'rgba(99, 102, 241, 0.3)' } },
                            axisLabel: { color: '#94a3b8' },
                            splitLine: { lineStyle: { color: 'rgba(99, 102, 241, 0.1)' } }
                        },
                        series: data.series.map((s, i) => ({
                            name: s.name,
                            type: 'line',
                            smooth: true,
                            stack: 'Total',
                            areaStyle: { opacity: 0.8 },
                            data: s.data,
                            itemStyle: { color: ['#3b82f6', '#8b5cf6', '#06b6d4', '#64748b'][i] }
                        }))
                    };
                    chart.setOption(option);
                    window.addEventListener('resize', () => chart.resize());
                },

                renderCompetitorChart() {
                    const chart = echarts.init(this.$refs.competitorChart);
                    const data = this.competitorData;

                    const option = {
                        tooltip: {
                            backgroundColor: 'rgba(15, 23, 42, 0.95)',
                            borderColor: 'rgba(99, 102, 241, 0.3)',
                            textStyle: { color: '#e2e8f0' }
                        },
                        legend: {
                            data: data.series.map(s => s.name),
                            top: 10,
                            textStyle: { color: '#94a3b8' }
                        },
                        radar: {
                            indicator: data.indicators.map(name => ({ name, max: 100 })),
                            shape: 'circle',
                            splitNumber: 5,
                            axisName: { color: '#94a3b8' },
                            splitLine: { lineStyle: { color: 'rgba(99, 102, 241, 0.2)' } },
                            splitArea: { areaStyle: { color: ['rgba(59, 130, 246, 0.05)', 'rgba(139, 92, 246, 0.05)'] } },
                            axisLine: { lineStyle: { color: 'rgba(99, 102, 241, 0.3)' } }
                        },
                        series: [{
                            name: 'ç«å“å¯¹æ¯”',
                            type: 'radar',
                            data: data.series.map((s, i) => ({
                                value: s.value,
                                name: s.name,
                                itemStyle: { color: ['#3b82f6', '#8b5cf6', '#06b6d4'][i] },
                                areaStyle: { opacity: 0.3 }
                            }))
                        }]
                    };
                    chart.setOption(option);
                    window.addEventListener('resize', () => chart.resize());
                },

                renderRegionalMapChart() {
                    const chart = echarts.init(this.$refs.regionalMapChart);
                    const data = this.regionalData;

                    const option = {
                        tooltip: {
                            trigger: 'item',
                            formatter: params => {
                                return `${params.name}<br/>é”€å”®é¢: ${params.value[1]}ä¸‡å…ƒ<br/>å¢é•¿ç‡: ${params.value[2]}%`;
                            },
                            backgroundColor: 'rgba(15, 23, 42, 0.95)',
                            borderColor: 'rgba(99, 102, 241, 0.3)',
                            textStyle: { color: '#e2e8f0' }
                        },
                        xAxis: {
                            type: 'category',
                            data: data.provinces,
                            axisLabel: {
                                rotate: 45,
                                color: '#94a3b8'
                            },
                            axisLine: { lineStyle: { color: 'rgba(99, 102, 241, 0.3)' } }
                        },
                        yAxis: {
                            type: 'category',
                            data: ['é«˜å¢é•¿', 'ä¸­é«˜å¢é•¿', 'ä¸­ç­‰å¢é•¿', 'ä½å¢é•¿'],
                            axisLabel: { color: '#94a3b8' },
                            axisLine: { lineStyle: { color: 'rgba(99, 102, 241, 0.3)' } },
                            splitLine: { lineStyle: { color: 'rgba(99, 102, 241, 0.1)' } }
                        },
                        visualMap: {
                            min: 0,
                            max: 15000,
                            calculable: true,
                            inRange: {
                                color: ['#10b981', '#3b82f6', '#8b5cf6']
                            },
                            show: false
                        },
                        series: [{
                            name: 'åŒºåŸŸè¡¨ç°',
                            type: 'scatter',
                            symbolSize: d => Math.sqrt(d[1]) / 4,
                            data: data.data,
                            itemStyle: {
                                color: params => {
                                    const growth = params.data[3];
                                    if (growth > 25) {
                                        return new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                            { offset: 0, color: '#8b5cf6' },
                                            { offset: 1, color: '#6366f1' }
                                        ]);
                                    } else if (growth > 20) {
                                        return new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                            { offset: 0, color: '#3b82f6' },
                                            { offset: 1, color: '#2563eb' }
                                        ]);
                                    } else {
                                        return new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                            { offset: 0, color: '#10b981' },
                                            { offset: 1, color: '#059669' }
                                        ]);
                                    }
                                },
                                shadowBlur: 15,
                                shadowColor: 'rgba(139, 92, 246, 0.4)',
                                shadowOffsetY: 5
                            },
                            label: {
                                show: true,
                                formatter: params => params.data[0],
                                position: 'top',
                                color: '#e2e8f0'
                            }
                        }]
                    };
                    chart.setOption(option);
                    window.addEventListener('resize', () => chart.resize());
                }
            }
        }).mount('#app');
    </script>
</body>
</html>
